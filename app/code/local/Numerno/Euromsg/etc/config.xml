<?xml version="1.0"?>
<!--
/**
 * Numerno - Euro.message Magento Extension
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the NUMERNO EUROMESSAGE MAGENTO EXTENSION License, which extends the Open Software
 * License (OSL 3.0). The Euro.message Magento Extension License is available at this URL:
 * http://numerno.com/licenses/euromsg-ce.txt The Open Software License is available at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * DISCLAIMER
 *
 * By adding to, editing, or in any way modifying this code, Numerno is not held liable for any inconsistencies or
 * abnormalities in the behaviour of this code. By adding to, editing, or in any way modifying this code, the Licensee
 * terminates any agreement of support offered by Numerno, outlined in the provided Euro.message Magento Extension
 * License.
 * Upon discovery of modified code in the process of support, the Licensee is still held accountable for any and all
 * billable time Numerno spent during the support process. Numerno does not guarantee compatibility with any other
 * Magento extension. Numerno is not responsbile for any inconsistencies or abnormalities in the behaviour of this
 * code if caused by other Magento extension.
 * If you did not receive a copy of the license, please send an email to info@numerno.com or call +90-212-223-5093,
 * so we can send you a copy immediately.
 *
 * @category   [Numerno]
 * @package    [Numerno_Euromsg]
 * @copyright  Copyright (c) 2015 Numerno Bilisim Hiz. Tic. Ltd. Sti. (http://numerno.com/)
 * @license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
-->
<config>
	<modules>
		<Numerno_Euromsg>
			<version>1.0.1</version>
		</Numerno_Euromsg>
	</modules>
    <admin>
        <routers>
            <adminhtml>
                <args>
                    <modules>
                        <euromsg after="Mage_Adminhtml">Numerno_Euromsg</euromsg>
                    </modules>
                </args>
            </adminhtml>
            <euromsg>
                <use>admin</use>
                <args>
                    <module>Numerno_Euromsg_Adminhtml</module>
                    <frontName>euromsg</frontName>
                </args>
            </euromsg>
        </routers>
    </admin>
	<global>
        <blocks>
            <adminhtml>
                <rewrite>
                    <customer_grid>Numerno_Euromsg_Block_Adminhtml_Customer_Grid</customer_grid>
                    <newsletter_subscriber_grid>Numerno_Euromsg_Block_Adminhtml_Newsletter_Subscriber_Grid</newsletter_subscriber_grid>
                    <sales_order_view_history>Numerno_Euromsg_Block_Adminhtml_Sales_Order_View_History</sales_order_view_history>
                    <sales_order_comments_view>Numerno_Euromsg_Block_Adminhtml_Sales_Order_Comments_View</sales_order_comments_view>
                </rewrite>
            </adminhtml>
            <euromsg>
                <class>Numerno_Euromsg_Block</class>
            </euromsg>
        </blocks>
        <fieldsets>
            <customer_account>
                <em_gsm_permit>
                    <create>1</create>
                    <update>1</update>
                </em_gsm_permit>
            </customer_account>
        </fieldsets>
		<helpers>
			<euromsg>
				<class>Numerno_Euromsg_Helper</class>
			</euromsg>
		</helpers>
		<models>
            <core>
                <rewrite>
                    <email>Numerno_Euromsg_Model_Core_Email</email>
                    <email_template>Numerno_Euromsg_Model_Core_Email_Template</email_template>
                    <email_queue>Numerno_Euromsg_Model_Core_Email_Queue</email_queue>
                </rewrite>
            </core>
			<euromsg>
				<class>Numerno_Euromsg_Model</class>
                <resourceModel>euromsg_resource</resourceModel>
			</euromsg>
            <euromsg_resource>
                <class>Numerno_Euromsg_Model_Resource</class>
                <entities>
                    <process>
                        <table>euromsg_process</table>
                    </process>
                    <mail_log>
                        <table>euromsg_mail_log</table>
                    </mail_log>
                    <sms>
                        <table>euromsg_sms_log</table>
                    </sms>
                </entities>
            </euromsg_resource>
            <newsletter>
                <resourceModel>newsletter_resource</resourceModel>
            </newsletter>
            <newsletter_resource>
                <rewrite>
                    <deprecatedNode>newsletter_mysql4</deprecatedNode>
                    <subscriber_collection>Numerno_Euromsg_Model_Newsletter_Subscriber_Collection</subscriber_collection>
                </rewrite>
            </newsletter_resource>
		</models>
        <resources>
            <euromsg_setup>
                <setup>
                    <module>Numerno_Euromsg</module>
                    <class>Mage_Customer_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </euromsg_setup>
        </resources>
	</global>
    <default>
        <euromsg>
            <general>
                <platform>liveb</platform>
            </general>
            <dwh>
                <sftp_host>file.euromsg.com</sftp_host>
            </dwh>
            <feedback>
                <autosync>0</autosync>
                <destination>local</destination>
                <local_dir>/var/euromsg</local_dir>
            </feedback>
        </euromsg>
        <euromsg_trx>
            <general>
                <enabled>0</enabled>
            </general>
        </euromsg_trx>
        <euromsg_customer>
            <general>
                <source>newsletter_subscribers</source>
                <use_unsubscribed>0</use_unsubscribed>
                <autosync>0</autosync>
                <filename>ALL_DATA</filename>
                <attributes>a:10:{s:16:"subscriber_email";a:2:{s:9:"attribute";s:16:"subscriber_email";s:8:"col_name";s:5:"EMAIL";}s:18:"customer_firstname";a:2:{s:9:"attribute";s:18:"customer_firstname";s:8:"col_name";s:4:"NAME";}s:17:"customer_lastname";a:2:{s:9:"attribute";s:17:"customer_lastname";s:8:"col_name";s:7:"SURNAME";}s:15:"customer_gender";a:2:{s:9:"attribute";s:15:"customer_gender";s:8:"col_name";s:6:"GENDER";}s:12:"customer_dob";a:2:{s:9:"attribute";s:12:"customer_dob";s:8:"col_name";s:10:"BIRTH_DATE";}s:19:"customer_created_at";a:2:{s:9:"attribute";s:19:"customer_created_at";s:8:"col_name";s:12:"CREATED_DATE";}s:19:"customer_last_login";a:2:{s:9:"attribute";s:19:"customer_last_login";s:8:"col_name";s:14:"LAST_WEB_LOGIN";}s:19:"customer_last_order";a:2:{s:9:"attribute";s:19:"customer_last_order";s:8:"col_name";s:18:"LAST_PURCHASE_DATE";}s:21:"customer_orders_total";a:2:{s:9:"attribute";s:21:"customer_orders_total";s:8:"col_name";s:16:"LIFETIME_REVENUE";}s:21:"customer_fav_category";a:2:{s:9:"attribute";s:21:"customer_fav_category";s:8:"col_name";s:17:"FAVORITE_CATEGORY";}}</attributes>
            </general>
        </euromsg_customer>
        <euromsg_catalog>
            <general>
                <export>1</export>
                <autosync>0</autosync>
                <attributes>a:6:{s:9:"entity_id";a:2:{s:9:"attribute";s:9:"entity_id";s:8:"col_name";s:10:"PRODUCT_ID";}s:4:"name";a:2:{s:9:"attribute";s:4:"name";s:8:"col_name";s:12:"PRODUCT_NAME";}s:5:"price";a:2:{s:9:"attribute";s:5:"color";s:8:"col_name";s:5:"COLOR";}s:9:"thumbnail";a:2:{s:9:"attribute";s:5:"price";s:8:"col_name";s:13:"PRODUCT_PRICE";}s:4:"_url";a:2:{s:9:"attribute";s:9:"thumbnail";s:8:"col_name";s:7:"IMG_URL";}s:14:"_root_category";a:2:{s:9:"attribute";s:4:"_url";s:8:"col_name";s:10:"TARGET_URL";}}</attributes>
            </general>
            <advanced>
                <filename>PRODUCTS</filename>
                <memory_limit>250000000</memory_limit>
                <memory_pp>100000</memory_pp>
                <memory_percent>80</memory_percent>
                <minimum_products>500</minimum_products>
            </advanced>
        </euromsg_catalog>
        <euromsg_trx>
            <general>
                <enabled>0</enabled>
            </general>
            <log>
                <enabled>0</enabled>
            </log>
        </euromsg_trx>
        <euromsg_sms>
            <general>
                <enabled>0</enabled>
                <method>standart</method>
            </general>
            <log>
                <enabled>0</enabled>
            </log>
        </euromsg_sms>
    </default>
    <crontab>
        <jobs>
            <euromsg_autosync_customers>
                <run>
                    <model>euromsg/cron::syncCustomerData</model>
                </run>
            </euromsg_autosync_customers>
            <euromsg_autosync_catalog>
                <run>
                    <model>euromsg/cron::syncCatalogData</model>
                </run>
            </euromsg_autosync_catalog>
            <euromsg_process_queue_run_all>
                <run>
                    <model>euromsg/cron::runAllProcesses</model>
                </run>
                <schedule>
                    <cron_expr>*/5 * * * *</cron_expr>
                </schedule>
            </euromsg_process_queue_run_all>
            <euromsg_datawarehouse_checkreports>
                <run>
                    <model>euromsg/cron::checkDwhReports</model>
                </run>
            </euromsg_datawarehouse_checkreports>
            <euromsg_sms_queue_send_all>
                <run>
                    <model>euromsg/cron::sendAllSms</model>
                </run>
                <schedule>
                    <cron_expr>*/5 * * * *</cron_expr>
                </schedule>
            </euromsg_sms_queue_send_all>
            <euromsg_email_log_cleanup>
                <run>
                    <model>euromsg/cron::cleanMailLogs</model>
                </run>
            </euromsg_email_log_cleanup>
            <euromsg_email_track_delivery>
                <schedule>
                    <cron_expr>*/5 * * * *</cron_expr>
                </schedule>
                <run>
                    <model>euromsg/cron::trackMailDelivery</model>
                </run>
            </euromsg_email_track_delivery>
        </jobs>
    </crontab>
    <adminhtml>
        <translate>
            <modules>
                <Numerno_Euromsg>
                    <files>
                        <default>Numerno_Euromsg.csv</default>
                    </files>
                </Numerno_Euromsg>
            </modules>
        </translate>
        <layout>
            <updates>
                <euromsg>
                    <file>euromsg.xml</file>
                </euromsg>
            </updates>
        </layout>
        <events>
            <controller_action_postdispatch_adminhtml_sales_order_addComment>
                <observers>
                    <euromsg_send_sms_order_update>
                        <class>euromsg/observer</class>
                        <method>sendOrderUpdateSms</method>
                    </euromsg_send_sms_order_update>
                </observers>
            </controller_action_postdispatch_adminhtml_sales_order_addComment>
            <controller_action_postdispatch_adminhtml_sales_order_invoice_addComment>
                <observers>
                    <euromsg_send_sms_invoice_update>
                        <class>euromsg/observer</class>
                        <method>sendInvoiceUpdateSms</method>
                    </euromsg_send_sms_invoice_update>
                </observers>
            </controller_action_postdispatch_adminhtml_sales_order_invoice_addComment>
            <controller_action_postdispatch_adminhtml_sales_order_shipment_addComment>
                <observers>
                    <euromsg_send_sms_shipment_update>
                        <class>euromsg/observer</class>
                        <method>sendShipmentUpdateSms</method>
                    </euromsg_send_sms_shipment_update>
                </observers>
            </controller_action_postdispatch_adminhtml_sales_order_shipment_addComment>
            <controller_action_postdispatch_adminhtml_sales_order_creditmemo_addComment>
                <observers>
                    <euromsg_send_sms_creditmemo_update>
                        <class>euromsg/observer</class>
                        <method>sendCreditmemoUpdateSms</method>
                    </euromsg_send_sms_creditmemo_update>
                </observers>
            </controller_action_postdispatch_adminhtml_sales_order_creditmemo_addComment>
        </events>
    </adminhtml>
    <frontend>
        <translate>
            <modules>
                <Numerno_Euromsg>
                    <files>
                        <default>Numerno_Euromsg.csv</default>
                    </files>
                </Numerno_Euromsg>
            </modules>
        </translate>
        <events>
            <sales_order_place_after>
                <observers>
                    <euromsg_send_sms_new_order>
                        <class>euromsg/observer</class>
                        <method>sendNewOrderSms</method>
                    </euromsg_send_sms_new_order>
                </observers>
            </sales_order_place_after>
            <sales_order_invoice_save_after>
                <observers>
                    <euromsg_send_sms_new_invoice>
                        <class>euromsg/observer</class>
                        <method>sendNewInvoiceSms</method>
                    </euromsg_send_sms_new_invoice>
                </observers>
            </sales_order_invoice_save_after>
            <sales_order_shipment_save_after>
                <observers>
                    <euromsg_send_sms_new_shipment>
                        <class>euromsg/observer</class>
                        <method>sendNewShipmentSms</method>
                    </euromsg_send_sms_new_shipment>
                </observers>
            </sales_order_shipment_save_after>
            <sales_order_shipment_track_save_after>
                <observers>
                    <euromsg_send_sms_new_track>
                        <class>euromsg/observer</class>
                        <method>sendNewTrackSms</method>
                    </euromsg_send_sms_new_track>
                </observers>
            </sales_order_shipment_track_save_after>
            <sales_order_creditmemo_save_after>
                <observers>
                    <euromsg_send_sms_new_creditmemo>
                        <class>euromsg/observer</class>
                        <method>sendNewCreditmemoSms</method>
                    </euromsg_send_sms_new_creditmemo>
                </observers>
            </sales_order_creditmemo_save_after>
        </events>
    </frontend>
</config>